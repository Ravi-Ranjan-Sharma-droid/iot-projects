<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ESP32 Smart Car Help</title>
    <style>
        :root {
            --primary-color: #2196F3;
            --primary-dark: #1976D2;
            --primary-light: #BBDEFB;
            --accent-color: #FF4081;
            --text-color: #212121;
            --text-secondary: #757575;
            --divider-color: #BDBDBD;
            --background-color: #F5F5F5;
            --card-color: #FFFFFF;
            --success-color: #4CAF50;
            --warning-color: #FFC107;
            --danger-color: #F44336;
            --code-bg: #F5F5F5;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            height: 100%;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 15px;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        header h1 {
            margin: 0;
            font-size: 1.5rem;
        }

        .card {
            background-color: var(--card-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        h2 {
            margin-top: 0;
            color: var(--primary-dark);
            font-size: 1.3rem;
        }

        h3 {
            color: var(--primary-color);
            font-size: 1.1rem;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        p {
            color: var(--text-secondary);
            line-height: 1.5;
        }

        ul, ol {
            color: var(--text-secondary);
            line-height: 1.5;
        }

        li {
            margin-bottom: 8px;
        }

        .tabs {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--divider-color);
        }

        .tab {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .tab.active {
            border-bottom-color: var(--primary-color);
            color: var(--primary-color);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .back-link {
            display: block;
            margin-top: 20px;
            color: var(--primary-color);
            text-decoration: none;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        .code {
            background-color: var(--code-bg);
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            overflow-x: auto;
            margin: 10px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        th, td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid var(--divider-color);
        }

        th {
            background-color: var(--primary-light);
            color: var(--primary-dark);
        }

        tr:nth-child(even) {
            background-color: rgba(0, 0, 0, 0.02);
        }

        .faq-item {
            margin-bottom: 20px;
        }

        .faq-question {
            font-weight: bold;
            color: var(--primary-dark);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .faq-question:after {
            content: '+';
            font-size: 1.2rem;
            transition: transform 0.3s;
        }

        .faq-question.active:after {
            content: '-';
        }

        .faq-answer {
            margin-top: 10px;
            display: none;
        }

        .faq-answer.active {
            display: block;
        }

        .troubleshooting-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--divider-color);
        }

        .troubleshooting-item:last-child {
            border-bottom: none;
        }

        .troubleshooting-problem {
            font-weight: bold;
            color: var(--danger-color);
        }

        .troubleshooting-solution {
            margin-top: 5px;
        }

        .pin-diagram {
            width: 100%;
            max-width: 600px;
            margin: 20px auto;
            display: block;
            border: 1px solid var(--divider-color);
            border-radius: 4px;
        }

        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }
            
            .tabs {
                overflow-x: auto;
                white-space: nowrap;
                flex-wrap: nowrap;
                -webkit-overflow-scrolling: touch;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ESP32 Smart Car Help</h1>
        </header>

        <div class="card">
            <div class="tabs">
                <div class="tab active" data-tab="quickstart">Quick Start</div>
                <div class="tab" data-tab="controls">Controls</div>
                <div class="tab" data-tab="calibration">Calibration</div>
                <div class="tab" data-tab="troubleshooting">Troubleshooting</div>
                <div class="tab" data-tab="faq">FAQ</div>
                <div class="tab" data-tab="pinout">Pinout</div>
            </div>
            
            <div class="tab-content active" id="quickstart-tab">
                <h2>Quick Start Guide</h2>
                <p>Welcome to your ESP32 Smart Car! Follow these steps to get started quickly:</p>
                
                <h3>1. Power On</h3>
                <p>Turn on the power switch located on the side of the car. The LED indicators will light up, and the ESP32 will boot up.</p>
                
                <h3>2. Connect to Wi-Fi</h3>
                <p>On your smartphone or tablet, go to Wi-Fi settings and connect to the network named <strong>"ESP32_SmartCar"</strong>. The default password is <strong>"smartcar123"</strong>.</p>
                
                <h3>3. Open the Control Interface</h3>
                <p>Open your web browser and navigate to <strong>http://192.168.4.1</strong>. This will load the control interface for your smart car.</p>
                
                <h3>4. Basic Controls</h3>
                <ul>
                    <li><strong>Joystick:</strong> Use the virtual joystick to control the car's movement.</li>
                    <li><strong>Headlights:</strong> Toggle the headlights on/off using the light button.</li>
                    <li><strong>Horn:</strong> Press the horn button to sound the buzzer.</li>
                    <li><strong>Indicators:</strong> Use the left/right indicator buttons for turn signals.</li>
                </ul>
                
                <h3>5. Battery Management</h3>
                <p>The battery level is displayed in the top right corner of the interface. When the battery is low, the car will automatically enter a low-power mode and eventually shut down to protect the battery.</p>
                
                <h3>6. Calibration</h3>
                <p>If this is your first time using the car, it's recommended to perform a motor calibration. Go to the <strong>Calibration</strong> page from the menu and follow the instructions.</p>
            </div>
            
            <div class="tab-content" id="controls-tab">
                <h2>Control Interface Guide</h2>
                
                <h3>Movement Controls</h3>
                <p>The smart car uses tank-style movement with independent control of left and right motors:</p>
                <ul>
                    <li><strong>Forward:</strong> Push the joystick up to move forward.</li>
                    <li><strong>Backward:</strong> Pull the joystick down to move backward.</li>
                    <li><strong>Turn Left:</strong> Push the joystick left to turn left (right motors move faster than left).</li>
                    <li><strong>Turn Right:</strong> Push the joystick right to turn right (left motors move faster than right).</li>
                    <li><strong>Spin Left:</strong> Push the joystick to the upper-left or lower-left corner to spin left (right motors move forward/backward, left motors move backward/forward).</li>
                    <li><strong>Spin Right:</strong> Push the joystick to the upper-right or lower-right corner to spin right (left motors move forward/backward, right motors move backward/forward).</li>
                </ul>
                
                <h3>Lighting Controls</h3>
                <ul>
                    <li><strong>Headlights:</strong> Toggle the headlights on/off. You can also adjust the brightness.</li>
                    <li><strong>Taillights:</strong> Automatically activate when moving backward or braking.</li>
                    <li><strong>Indicators:</strong> Use the left/right buttons to signal turns. Press the hazard button for emergency flashing.</li>
                    <li><strong>Underglow:</strong> Change the color and animation pattern of the underglow LEDs.</li>
                </ul>
                
                <h3>Additional Controls</h3>
                <ul>
                    <li><strong>Horn:</strong> Press the horn button to sound the buzzer.</li>
                    <li><strong>Speed Control:</strong> Adjust the maximum speed using the speed slider.</li>
                </ul>
                
                <h3>Dashboard Information</h3>
                <ul>
                    <li><strong>Battery Level:</strong> Shows the current battery voltage and percentage.</li>
                    <li><strong>Motor Speed:</strong> Displays the current speed of left and right motors.</li>
                    <li><strong>System Status:</strong> Indicates if any failsafe mechanisms are active.</li>
                </ul>
            </div>
            
            <div class="tab-content" id="calibration-tab">
                <h2>Calibration Guide</h2>
                <p>Calibration ensures optimal performance of your smart car. There are two main calibration procedures:</p>
                
                <h3>Motor Calibration</h3>
                <p>Motor calibration adjusts the motor parameters to ensure balanced movement:</p>
                <ol>
                    <li>Go to the <strong>Calibration</strong> page from the menu.</li>
                    <li>Place the car on a flat surface with wheels elevated (so it doesn't drive away).</li>
                    <li>Click the <strong>Start Full Calibration</strong> button.</li>
                    <li>The system will run each motor individually and adjust parameters automatically.</li>
                    <li>You can also test individual motors using the + and - buttons for each motor.</li>
                    <li>When finished, click <strong>Stop All Motors</strong>.</li>
                </ol>
                
                <h3>Battery Calibration</h3>
                <p>Battery calibration ensures accurate voltage readings and proper low-battery protection:</p>
                <ol>
                    <li>Go to the <strong>Calibration</strong> page from the menu.</li>
                    <li>Measure the actual battery voltage using a multimeter.</li>
                    <li>Enter the measured voltage in the <strong>Measured Battery Voltage</strong> field.</li>
                    <li>Click the <strong>Calibrate Battery</strong> button.</li>
                    <li>The system will adjust the voltage divider ratio to match your measurement.</li>
                </ol>
                
                <h3>When to Calibrate</h3>
                <ul>
                    <li>After first assembly</li>
                    <li>When the car doesn't drive straight</li>
                    <li>After replacing motors or batteries</li>
                    <li>When battery percentage seems inaccurate</li>
                </ul>
            </div>
            
            <div class="tab-content" id="troubleshooting-tab">
                <h2>Troubleshooting</h2>
                <p>Common issues and their solutions:</p>
                
                <div class="troubleshooting-item">
                    <div class="troubleshooting-problem">Car doesn't power on</div>
                    <div class="troubleshooting-solution">
                        <ul>
                            <li>Check if the battery is charged</li>
                            <li>Verify the power switch is in the ON position</li>
                            <li>Check all connections between the battery and ESP32</li>
                            <li>Measure the battery voltage with a multimeter (should be above 6V)</li>
                        </ul>
                    </div>
                </div>
                
                <div class="troubleshooting-item">
                    <div class="troubleshooting-problem">Cannot connect to Wi-Fi network</div>
                    <div class="troubleshooting-solution">
                        <ul>
                            <li>Make sure the car is powered on and the ESP32 is running</li>
                            <li>Check if the Wi-Fi network "ESP32_SmartCar" appears in your device's Wi-Fi list</li>
                            <li>Try restarting the car</li>
                            <li>Try restarting your smartphone/tablet's Wi-Fi</li>
                            <li>Make sure you're using the correct password (default: "smartcar123")</li>
                        </ul>
                    </div>
                </div>
                
                <div class="troubleshooting-item">
                    <div class="troubleshooting-problem">Web interface doesn't load</div>
                    <div class="troubleshooting-solution">
                        <ul>
                            <li>Verify you're connected to the "ESP32_SmartCar" Wi-Fi network</li>
                            <li>Try accessing <strong>http://192.168.4.1</strong> in your browser</li>
                            <li>Try a different browser</li>
                            <li>Clear your browser cache</li>
                            <li>Restart the car</li>
                        </ul>
                    </div>
                </div>
                
                <div class="troubleshooting-item">
                    <div class="troubleshooting-problem">Motors don't respond</div>
                    <div class="troubleshooting-solution">
                        <ul>
                            <li>Check if a failsafe mechanism is active (indicated on the dashboard)</li>
                            <li>Verify the battery level is sufficient</li>
                            <li>Check all connections between the ESP32, motor driver, and motors</li>
                            <li>Try calibrating the motors</li>
                            <li>Check if the motor driver is getting power (LED indicators)</li>
                        </ul>
                    </div>
                </div>
                
                <div class="troubleshooting-item">
                    <div class="troubleshooting-problem">Car moves erratically or doesn't drive straight</div>
                    <div class="troubleshooting-solution">
                        <ul>
                            <li>Perform motor calibration</li>
                            <li>Check if all wheels are properly attached and spinning freely</li>
                            <li>Verify that no wires are interfering with the wheels</li>
                            <li>Check for physical damage to the wheels or chassis</li>
                        </ul>
                    </div>
                </div>
                
                <div class="troubleshooting-item">
                    <div class="troubleshooting-problem">Battery drains quickly</div>
                    <div class="troubleshooting-solution">
                        <ul>
                            <li>Check for short circuits</li>
                            <li>Verify the motors aren't stalling or encountering resistance</li>
                            <li>Reduce the brightness of LEDs</li>
                            <li>Consider replacing the battery if it's old</li>
                        </ul>
                    </div>
                </div>
                
                <div class="troubleshooting-item">
                    <div class="troubleshooting-problem">Failsafe keeps activating</div>
                    <div class="troubleshooting-solution">
                        <ul>
                            <li>Check the battery voltage</li>
                            <li>Look for motor blockages</li>
                            <li>Verify there's no excessive current draw</li>
                            <li>Reset the failsafe from the Calibration page</li>
                        </ul>
                    </div>
                </div>
                
                <div class="troubleshooting-item">
                    <div class="troubleshooting-problem">OTA update fails</div>
                    <div class="troubleshooting-solution">
                        <ul>
                            <li>Ensure the battery is fully charged before updating</li>
                            <li>Verify you're using the correct firmware file format (.bin)</li>
                            <li>Check that the file size is not too large</li>
                            <li>Make sure your connection to the car's Wi-Fi is stable</li>
                            <li>Try restarting the car and attempting the update again</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="faq-tab">
                <h2>Frequently Asked Questions</h2>
                
                <div class="faq-item">
                    <div class="faq-question">How long does the battery last?</div>
                    <div class="faq-answer">
                        <p>With normal usage, the battery should last approximately 1-2 hours of continuous operation. This can vary based on factors like motor usage, LED brightness, and whether features like the horn are used frequently.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">How do I charge the battery?</div>
                    <div class="faq-answer">
                        <p>The battery can be charged using the micro-USB port on the battery management system (BMS). Use a standard 5V charger with at least 1A output. A full charge typically takes 2-3 hours. The BMS has LED indicators for charging status.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">What is the range of the Wi-Fi control?</div>
                    <div class="faq-answer">
                        <p>The ESP32's Wi-Fi has a range of approximately 30-50 meters (100-150 feet) in open areas. Walls and other obstacles will reduce this range. For best performance, stay within 20 meters (65 feet) of the car.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">Can I change the Wi-Fi name and password?</div>
                    <div class="faq-answer">
                        <p>Yes, you can change the Wi-Fi SSID and password by modifying the firmware. This requires reprogramming the ESP32 with updated settings. In a future update, we plan to add this feature to the web interface.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">What surfaces can the car drive on?</div>
                    <div class="faq-answer">
                        <p>The car performs best on smooth, flat surfaces like hardwood floors, tile, and short-pile carpet. It can handle slight inclines and small obstacles, but is not designed for rough terrain, sand, or water.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">How do I update the firmware?</div>
                    <div class="faq-answer">
                        <p>Go to the Update page from the menu. You can upload a new firmware file (.bin) or web interface package (.zip). Make sure the battery is fully charged before performing updates to prevent issues during the update process.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">Why does the car stop suddenly?</div>
                    <div class="faq-answer">
                        <p>The car has several failsafe mechanisms that can cause it to stop:
                        <ul>
                            <li>Low battery protection</li>
                            <li>Motor overcurrent protection</li>
                            <li>Motor stall detection</li>
                            <li>Communication timeout (if no commands are received for a period)</li>
                        </ul>
                        Check the dashboard for specific failsafe indicators.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">Can I add more features or sensors?</div>
                    <div class="faq-answer">
                        <p>Yes, the ESP32 has additional GPIO pins available for expansion. You can add sensors like ultrasonic distance sensors, line followers, or even a camera module. This would require modifying the firmware and possibly the web interface to support the new features.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">How do I perform a factory reset?</div>
                    <div class="faq-answer">
                        <p>Go to the Calibration page and click the "Factory Reset" button. This will erase all calibration data and settings, returning the car to its default configuration. The car will restart automatically after the reset.</p>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="pinout-tab">
                <h2>Pinout and Wiring Diagram</h2>
                <p>Below is the pinout information for the ESP32 and connections to other components:</p>
                
                <h3>ESP32 Pin Assignments</h3>
                <table>
                    <tr>
                        <th>Component</th>
                        <th>Function</th>
                        <th>ESP32 Pin</th>
                    </tr>
                    <tr>
                        <td rowspan="4">Motor Driver (L298N)</td>
                        <td>Left Motors Forward</td>
                        <td>GPIO 26</td>
                    </tr>
                    <tr>
                        <td>Left Motors Backward</td>
                        <td>GPIO 25</td>
                    </tr>
                    <tr>
                        <td>Right Motors Forward</td>
                        <td>GPIO 33</td>
                    </tr>
                    <tr>
                        <td>Right Motors Backward</td>
                        <td>GPIO 32</td>
                    </tr>
                    <tr>
                        <td rowspan="2">PWM Speed Control</td>
                        <td>Left Motors Enable</td>
                        <td>GPIO 14</td>
                    </tr>
                    <tr>
                        <td>Right Motors Enable</td>
                        <td>GPIO 27</td>
                    </tr>
                    <tr>
                        <td rowspan="3">Headlights</td>
                        <td>Left Headlight</td>
                        <td>GPIO 4</td>
                    </tr>
                    <tr>
                        <td>Right Headlight</td>
                        <td>GPIO 16</td>
                    </tr>
                    <tr>
                        <td>Brightness Control</td>
                        <td>GPIO 17</td>
                    </tr>
                    <tr>
                        <td rowspan="2">Taillights</td>
                        <td>Left Taillight</td>
                        <td>GPIO 18</td>
                    </tr>
                    <tr>
                        <td>Right Taillight</td>
                        <td>GPIO 19</td>
                    </tr>
                    <tr>
                        <td rowspan="2">Indicators</td>
                        <td>Left Indicator</td>
                        <td>GPIO 21</td>
                    </tr>
                    <tr>
                        <td>Right Indicator</td>
                        <td>GPIO 22</td>
                    </tr>
                    <tr>
                        <td>Underglow LEDs</td>
                        <td>Data Pin (WS2812B)</td>
                        <td>GPIO 23</td>
                    </tr>
                    <tr>
                        <td>Horn/Buzzer</td>
                        <td>Signal</td>
                        <td>GPIO 5</td>
                    </tr>
                    <tr>
                        <td>Battery Monitoring</td>
                        <td>Voltage Sensor</td>
                        <td>GPIO 34 (ADC)</td>
                    </tr>
                </table>
                
                <h3>Wiring Diagram</h3>
                <p>The diagram below shows how all components are connected:</p>
                <div class="code">
                    +---------------+     +----------------+     +----------------+
                    |               |     |                |     |                |
                    |    ESP32      |     |    L298N       |     |   Motors       |
                    |               |     |  Motor Driver  |     |                |
                    +-------+-------+     +--------+-------+     +----------------+
                            |                      |
                            +----------------------+
                            |
                    +-------+-------+     +----------------+     +----------------+
                    |               |     |                |     |                |
                    |  Lights &     |     |   Battery &    |     |   Power        |
                    |  Indicators   |     |   Monitoring   |     |   Management   |
                    +---------------+     +----------------+     +----------------+
                </div>
                
                <p>For a detailed circuit diagram, please refer to the README.md file in the project documentation.</p>
            </div>
        </div>

        <a href="/" class="back-link">← Back to Control Panel</a>
    </div>

    <script>
        // Tab switching
        function setupTabs() {
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    
                    // Remove active class from all tabs and contents
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    // Add active class to selected tab and content
                    tab.classList.add('active');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
        }
        
        // FAQ accordion
        function setupFAQ() {
            const questions = document.querySelectorAll('.faq-question');
            
            questions.forEach(question => {
                question.addEventListener('click', () => {
                    const answer = question.nextElementSibling;
                    
                    // Toggle active class
                    question.classList.toggle('active');
                    answer.classList.toggle('active');
                });
            });
        }
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', () => {
            setupTabs();
            setupFAQ();
        });
    </script>
</body>
</html>